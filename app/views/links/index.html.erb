<div class='container'>
	<%= render 'partials/disabled_account' %>

	<div class="row">
			<div class="col col-lg-2">
				<h3>Last 7 days</h3>
			</div>
			<div class="col col-lg-7"></div>
			<div class="col col-lg-3">
				<%= form_tag(reports_path, class: 'form-inline', method: :post)  do %>
					<div class="form-group mx-sm-3 mb-2">
						<%= select_tag :filter, options_for_select(['7 days', '15 days', '30 days']), {class: "form-control"} %>
					</div>
					<%= submit_tag 'Download', class: "btn btn-download mb-2" %>
				<% end %>
			</div>
		</div>
		<hr>

	<div class="row">
		<div class="col-sm-12">
			<%= line_chart Tracking.joins(:link).where(links: {user_id: current_user.id}, created_at: 7.days.ago..Time.now).group_by_day('trackings.created_at', format: "%a %d/%m/%y").count %>
		</div>
	</div>

	<legend>Links</legend>
	<div class='table-responsive'>          
		<table class="table">
			<thead>
				<tr>
					<th>#</th>
					<th>Token</th>
					<th>Original Url</th>
					<th>Short Url</th>
					<th>Created at</th>
					<th>Clicks</th>
				</tr>
			</thead>
			<tbody>
			<% @links.each do |link| %>
				<tr>
					<td><%= link.id %></td>
					<td><%= link.token %></td>
					<td><%= link.original_url %></td>
					<td><%= link.short_url %></td>
					<td><%= link.created_at %></td>
					<td><%= link.trackings_count %></td>
				</tr>
			<% end %>
			</tbody>
		</table>
	</div>
</div>

<p class="text-center">
	<% if params[:page].to_i > 1 %>
	<% back_params = {page: (params[:page].to_i-1)}.update({q: params[:q]}) %>
	<%= link_to "Back", links_url(back_params), class: 'btn btn-large btn-primary' %>
	<% end %>
	<% next_params = {page: (params[:page].to_i+1)}.update({q: params[:q]}) %>
	<%= link_to "Next", links_url(next_params), class: 'btn btn-large btn-primary' %>
</p>

<%= stylesheet_link_tag 'download' %>